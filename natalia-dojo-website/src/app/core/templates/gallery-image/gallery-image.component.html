<div class="gallery-item" (click)="onImageClick()">
  <div class="image-container">
    <img [src]="image.src" [alt]="image.alt" class="img-fluid rounded shadow-sm gallery-image"
      (load)="onImageLoad($event)" (error)="onImageError($event)"
      style="width: 100%; height: 200px; object-fit: cover; cursor: pointer;">
      @if (!image.loaded && !image.error) {
        <div class="image-loading">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">טוען...</span>
          </div>
        </div>
      }
      @if (image.error) {
        <div class="image-error">
          <i class="fas fa-exclamation-triangle text-warning"></i>
          <span>שגיאה בטעינת התמונה</span>
        </div>
      }
    </div>
    <div class="gallery-overlay">
      <div class="gallery-title">{{ image.title }}</div>
    </div>
  </div>

  <!-- Modal for full-size image -->
  @if (showModal) {
    <div class="modal fade show" [class.d-block]="showModal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="btn-close" (click)="closeModal()"></button>
            <h5 class="modal-title">{{ selectedImage?.title }}</h5>
            <button type="button" class="btn btn-outline-primary btn-sm" (click)="viewFullImage()" title="צפה בתמונה מלאה">
              <i class="fas fa-expand"></i>
            </button>
          </div>
          <div class="modal-body text-center">
            <img [src]="selectedImage?.src" [alt]="selectedImage?.alt" class="img-fluid">
          </div>
          <div class="modal-footer justify-content-between">
            <button type="button" class="btn btn-secondary" (click)="previousImage()">
              <i class="fas fa-chevron-right"></i> הקודם
            </button>
            <div class="text-muted small">
              <i class="fas fa-keyboard"></i> מקשי מקלדת: ← → לניווט, ESC לסגירה
            </div>
            <button type="button" class="btn btn-secondary" (click)="nextImage()">
              הבא <i class="fas fa-chevron-left"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  }

  <!-- Full Image Modal -->
  @if (showFullImageModal) {
    <div class="modal fade show" [class.d-block]="showFullImageModal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="btn-close" (click)="closeFullImageModal()"></button>
            <h5 class="modal-title">{{ selectedImage?.title }} - תמונה מלאה</h5>
          </div>
          <div class="modal-body text-center p-0">
            <img [src]="selectedImage?.src" [alt]="selectedImage?.alt" class="img-fluid w-100 h-100" style="object-fit: contain;">
          </div>
        </div>
      </div>
    </div>
  }

  <!-- Modal backdrop -->
  @if (showModal || showFullImageModal) {
    <div class="modal-backdrop fade show" (click)="closeModal()"></div>
  }