@if (audioSrc) {
  <div class="audio-player">
    <div class="audio-player__header">
      <h3 class="audio-player__title">
        <i class="bi bi-headphones" aria-hidden="true"></i>
        {{ title }}
        @if (author) {
          <span class="audio-player__author"> - {{ author }}</span>
        }
      </h3>
    </div>
    <audio #audioElement [src]="audioSrc" preload="metadata"></audio>
    @if (!hasError) {
      <div class="audio-player__controls">
        <button
          class="audio-player__play-btn"
          (click)="togglePlayPause()"
          [disabled]="isLoading"
          [attr.aria-label]="isPlaying ? 'עצור' : 'נגן'"
          [attr.aria-pressed]="isPlaying">
          <i class="bi"
            [class.bi-pause-fill]="isPlaying"
            [class.bi-play-fill]="!isPlaying"
          aria-hidden="true"></i>
        </button>
        <div class="audio-player__progress-container">
          <span class="audio-player__time">{{ formatTime(currentTime) }}</span>
          <input
            type="range"
            class="audio-player__progress"
            dir="rtl"
            [value]="progressPercentage"
            (input)="onSeek($event)"
            [style.--progress]="progressPercentage + '%'"
            min="0"
            max="100"
            step="0.1"
            [disabled]="isLoading || !duration"
            aria-label="התקדמות השמעה">
          <span class="audio-player__time">{{ formatTime(duration) }}</span>
        </div>
        @if (isLoading) {
          <div class="audio-player__loading">
            <div class="spinner-border spinner-border-sm" role="status">
              <span class="visually-hidden">טוען...</span>
            </div>
          </div>
        }
      </div>
    }
    @if (hasError) {
      <div class="audio-player__error">
        <i class="bi bi-exclamation-triangle" aria-hidden="true"></i>
        <span>{{ errorMessage || 'שגיאה בטעינת האודיו' }}</span>
      </div>
    }
  </div>
}

