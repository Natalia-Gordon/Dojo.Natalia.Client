@if (userInfo && isBrowser) {
  <div class="user-menu-container">
    <!-- User Avatar Button -->
    <button
      type="button"
      class="user-avatar-btn"
      (click)="onAvatarClick()"
      [class.active]="isMenuOpen">
      <div class="user-avatar">
        <span class="avatar-initial">{{ getInitials() }}</span>
      </div>
    </button>
    <!-- Dropdown Menu -->
    @if (isMenuOpen) {
      <div class="user-menu-dropdown">
        <!-- User Header Section -->
        <div class="user-menu-header">
          <button
            type="button"
            class="user-avatar-large-btn"
            (click)="onMenuAvatarClick()"
            title="×¤×¨×˜×™ ××©×ª××©">
            <div class="user-avatar-large">
              <span class="avatar-initial-large">{{ getInitials() }}</span>
            </div>
          </button>
          <div class="user-info">
            <div class="user-name">{{ userInfo.displayName || userInfo.username }}</div>
            @if (userInfo.lastLoginAt) {
              <div class="user-last-login">
                ×”×ª×—×‘×¨×•×ª ××—×¨×•× ×”: {{ formatLastLogin(userInfo.lastLoginAt) }}
              </div>
            }
            <div class="user-badges">
              <span class="badge" [ngClass]="getLevelColor(userInfo.level)">
                {{ userInfo.level || 'User' }}
              </span>
              @if (userInfo.role) {
                <span class="badge badge-role">
                  {{ userInfo.role }}
                </span>
              }
            </div>
          </div>
        </div>
        <!-- Separator -->
        <div class="menu-separator"></div>
        <!-- Menu Items -->
        <div class="menu-items">
          <a href="#" class="menu-item" (click)="onUserDetailsClick(); $event.preventDefault()">
            <span class="menu-icon">âš™ï¸</span>
            <span>×¤×¨×•×¤×™×œ ××©×ª××©</span>
          </a>
          <a href="#" class="menu-item" (click)="onMyEventsClick(); $event.preventDefault()">
            <span class="menu-icon">ğŸ“…</span>
            <span>××™×¨×•×¢×™× ×©×œ×™</span>
          </a>
          @if (isAdmin()) {
            <a href="#" class="menu-item" (click)="onManageUsersClick(); $event.preventDefault()">
              <span class="menu-icon">ğŸ‘¥</span>
              <span>× ×™×”×•×œ ××©×ª××©×™×</span>
            </a>
            <a href="#" class="menu-item" (click)="onManageEventsClick(); $event.preventDefault()">
              <span class="menu-icon">ğŸ“‹</span>
              <span>× ×™×”×•×œ ××™×¨×•×¢×™×</span>
            </a>
          }
          @if (isTeacherOrInstructor()) {
            <a href="#" class="menu-item" (click)="onRegisterNewUserClick(); $event.preventDefault()">
              <span class="menu-icon">â•</span>
              <span>×¨×™×©×•× ××©×ª××© ×—×“×©</span>
            </a>
          }
          <a href="#" class="menu-item" (click)="closeMenu(); $event.preventDefault()">
            <span class="menu-icon">ğŸ›’</span>
            <span>×”×¨×›×™×©×•×ª ×©×œ×™</span>
          </a>
        </div>
        <!-- Separator -->
        <div class="menu-separator"></div>
        <!-- Logout Button -->
        <button type="button" class="menu-item menu-item-logout" (click)="onLogout()">
          <span class="menu-icon">ğŸšª</span>
          <span>×”×ª× ×ª×§×•×ª</span>
        </button>
      </div>
    }
  </div>
}
